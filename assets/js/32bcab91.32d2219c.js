"use strict";(self.webpackChunksaasus_platform_document=self.webpackChunksaasus_platform_document||[]).push([[5632],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>d});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=p(a),h=i,d=u["".concat(s,".").concat(h)]||u[h]||c[h]||r;return a?n.createElement(d,l(l({ref:t},m),{},{components:a})):n.createElement(d,l({ref:t},m))}));function d(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,l=new Array(r);l[0]=h;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},51851:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var n=a(87462),i=(a(67294),a(3905));const r={title:"Implementing Authentication Using SaaSus Platform (API Server)",slug:"implementing-authentication-using-saasus-platform-apiserver",excerpt:"",hidden:!1,createdAt:"Sun Aug 06 2023 02:41:08 GMT+0000 (Coordinated Universal Time)",updatedAt:"Wed Jan 17 2024 08:25:52 GMT+0000 (Coordinated Universal Time)"},l=void 0,o={unversionedId:"implementation-guide/implementing-authentication-using-saasus-platform-apiserver",id:"version-1.6/implementation-guide/implementing-authentication-using-saasus-platform-apiserver",title:"Implementing Authentication Using SaaSus Platform (API Server)",description:"When configuring the backend as an API server, the following implementations are necessary:",source:"@site/versioned_docs/version-1.6/implementation-guide/implementing-authentication-using-saasus-platform-apiserver.md",sourceDirName:"implementation-guide",slug:"/implementation-guide/implementing-authentication-using-saasus-platform-apiserver",permalink:"/docs/implementation-guide/implementing-authentication-using-saasus-platform-apiserver",draft:!1,tags:[],version:"1.6",frontMatter:{title:"Implementing Authentication Using SaaSus Platform (API Server)",slug:"implementing-authentication-using-saasus-platform-apiserver",excerpt:"",hidden:!1,createdAt:"Sun Aug 06 2023 02:41:08 GMT+0000 (Coordinated Universal Time)",updatedAt:"Wed Jan 17 2024 08:25:52 GMT+0000 (Coordinated Universal Time)"},sidebar:"tutorialSidebar",previous:{title:"Summary",permalink:"/docs/tutorial/summarize"},next:{title:"Implementation using SaaSus Platform (Serverless)",permalink:"/docs/implementation-guide/implementing-authentication-using-saasus-serverless"}},s={},p=[{value:"1. Frontend Implementation",id:"1-frontend-implementation",level:2},{value:"1.1. Description of the Implementation Sample",id:"11-description-of-the-implementation-sample",level:3},{value:"1.1.1. Post-Authentication Redirect Screen",id:"111-post-authentication-redirect-screen",level:4},{value:"1.1.2. Self-Signup Screen",id:"112-self-signup-screen",level:4},{value:"1.1.3. User List Screen (Homepage)",id:"113-user-list-screen-homepage",level:4},{value:"1.2. How to Use the Implementation Sample",id:"12-how-to-use-the-implementation-sample",level:3},{value:"2. Backend Implementation",id:"2-backend-implementation",level:2},{value:"2.1. Description of the Implementation Sample",id:"21-description-of-the-implementation-sample",level:3},{value:"2.1.1. JWT Retrieval API",id:"211-jwt-retrieval-api",level:4},{value:"2.1.2. User Information Retrieval API",id:"212-user-information-retrieval-api",level:4},{value:"2.1.3. Self-Signup API",id:"213-self-signup-api",level:4},{value:"2.1.4. User List Retrieval API",id:"214-user-list-retrieval-api",level:4},{value:"2.2. How to use the implementation example",id:"22-how-to-use-the-implementation-example",level:4}],m={toc:p},u="wrapper";function c(e){let{components:t,...r}=e;return(0,i.kt)(u,(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"When configuring the backend as an API server, the following implementations are necessary:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Store the token (JWT), which is the authentication information for the SaaSus Platform, in the browser's local storage."),(0,i.kt)("li",{parentName:"ul"},"SaaS Platform users authenticate themselves using JWT."),(0,i.kt)("li",{parentName:"ul"},"The frontend is implemented with React, Vue.js, etc."),(0,i.kt)("li",{parentName:"ul"},"The backend API server is implemented in PHP / TypeScript / Go / Python / C# / JAVA, etc.")),(0,i.kt)("h1",{id:"process-flow-login-to-user-list-display"},"Process Flow (Login to User List Display)"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"SaaSus Platform API Process Flow",src:a(76192).Z,width:"1058",height:"1036"})),(0,i.kt)("h1",{id:"implementation-sample"},"Implementation Sample"),(0,i.kt)("h2",{id:"1-frontend-implementation"},"1. Frontend Implementation"),(0,i.kt)("h3",{id:"11-description-of-the-implementation-sample"},"1.1. Description of the Implementation Sample"),(0,i.kt)("h4",{id:"111-post-authentication-redirect-screen"},"1.1.1. Post-Authentication Redirect Screen"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-front-react/blob/main/src/pages/Callback.tsx"},"React implementation sample")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-front-vue/blob/main/src/views/Callback.vue"},"Vue.js implementation sample"))),(0,i.kt)("p",null,"When you log in from the login screen generated by the SaaSus Platform, the URL set as the post-authentication redirect is called."),(0,i.kt)("p",null,"To perform a test run using this implementation sample, set it as ",(0,i.kt)("inlineCode",{parentName:"p"},"http://localhost:3000/callback"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Post-Authentication Redirect",src:a(21690).Z,width:"2464",height:"736"})),(0,i.kt)("p",null,"At the post-authentication redirect, a temporary code necessary for obtaining authentication information is passed in the query parameter (code=xxxxx). Implement the process to obtain JWT using this temporary code and save it in local storage."),(0,i.kt)("h4",{id:"112-self-signup-screen"},"1.1.2. Self-Signup Screen"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"React implementation sample (In preparation)")),(0,i.kt)("p",null,"It is necessary to check if the user is logged in, so call the API to get user information and confirm that the user is logged in.",(0,i.kt)("br",{parentName:"p"}),"\n","Use the JWT stored in local storage for the API call.",(0,i.kt)("br",{parentName:"p"}),"\n","By being able to obtain user information, you can confirm that the user is logged in."),(0,i.kt)("p",null,"The process for self-signup should be implemented according to whether self-signup is used or not.",(0,i.kt)("br",{parentName:"p"}),"\n","If self-signup is not used, the screen for self-signup is not needed."),(0,i.kt)("p",null,"If self-signup is used, the process for self-signup will only be executed during the first login.",(0,i.kt)("br",{parentName:"p"}),"\n","Whether it is the first login can be determined by whether the logging-in user is linked to a tenant."),(0,i.kt)("h4",{id:"113-user-list-screen-homepage"},"1.1.3. User List Screen (Homepage)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-front-react/blob/main/src/pages/UserPage.tsx"},"React implementation sample")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-front-vue/blob/main/src/views/UserPage.vue"},"Vue.js implementation sample"))),(0,i.kt)("p",null,"Regarding the use of user information obtained from the /userinfo endpoint:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"tenants array"),":",(0,i.kt)("br",{parentName:"p"}),"\n","In the design of your SaaS,",(0,i.kt)("br",{parentName:"p"}),"\n","if it is fixed to 1 tenant per 1 user, use ",(0,i.kt)("inlineCode",{parentName:"p"},"tenants[0]")," fixed.",(0,i.kt)("br",{parentName:"p"}),"\n","If a user belongs to multiple tenants, it is necessary to decide which tenant to use.",(0,i.kt)("br",{parentName:"p"}),"\n","Example: Users linked to multiple tenants will see a tenant selection screen after logging in to choose a tenant.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"envs array"),":",(0,i.kt)("br",{parentName:"p"}),"\n","id(name)\u30101(dev), 2(stg), 3(prod)\u3011",(0,i.kt)("br",{parentName:"p"}),"\n","dev, stg, prod do not refer to your SaaS's environments.",(0,i.kt)("br",{parentName:"p"}),"\n","Example: In your SaaS's production environment, if users use test users as a sandbox, use 1(dev), 2(stg). Normally, use 3(prod).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"roles array"),":",(0,i.kt)("br",{parentName:"p"}),"\n","In the design of your SaaS,",(0,i.kt)("br",{parentName:"p"}),"\n","if it is fixed to 1 role per 1 user, use ",(0,i.kt)("inlineCode",{parentName:"p"},"roles[0]")," fixed.",(0,i.kt)("br",{parentName:"p"}),"\n","If a user has multiple roles, an implementation to check all roles is needed.",(0,i.kt)("br",{parentName:"p"}),"\n","Example: If it is possible to assign two permissions such as a general user and administrator,",(0,i.kt)("br",{parentName:"p"}),"\n","when displaying an admin-only management screen, an implementation to reference all roles is needed."))),(0,i.kt)("h3",{id:"12-how-to-use-the-implementation-sample"},"1.2. How to Use the Implementation Sample"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-front-react/blob/main/README.md"},"React")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-front-vue/blob/main/README.md"},"Vue.js"))),(0,i.kt)("h2",{id:"2-backend-implementation"},"2. Backend Implementation"),(0,i.kt)("h3",{id:"21-description-of-the-implementation-sample"},"2.1. Description of the Implementation Sample"),(0,i.kt)("h4",{id:"211-jwt-retrieval-api"},"2.1.1. JWT Retrieval API"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-go/blob/main/main.go#L82"},"Go(echo) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'e.GET("/credentials", getCredentials)')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-python/blob/main/main.py#L48"},"Python(FastAPI) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'@app.get("/credentials")')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-java/blob/main/src/main/java/implementsample/controller/SampleController.java#L36"},"Java(Maven) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'@GetMapping(value = "/credentials", produces = "application/json")'))),(0,i.kt)("h4",{id:"212-user-information-retrieval-api"},"2.1.2. User Information Retrieval API"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-go/blob/main/main.go#L144"},"Go(echo) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'e.GET("/userinfo", getMe, authMiddleware)')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-python/blob/main/main.py#L53"},"Python(FastAPI) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'@app.get("/userinfo")')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-java/blob/main/src/main/java/implementsample/controller/SampleController.java#L82"},"Java(Maven) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'@GetMapping(value = "/userinfo", produces = "application/json")'))),(0,i.kt)("h4",{id:"213-self-signup-api"},"2.1.3. Self-Signup API"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Go(echo) implementation sample (Preparation in progress)"),(0,i.kt)("li",{parentName:"ul"},"Python implementation sample (Preparation in progress)")),(0,i.kt)("p",null,"In order to confirm that the API request is from the user who logged into the SaaSus Platform, it is always necessary to confirm the login by retrieving the user information. The self-signup process is as follows:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Prerequisite) The user who self-signs up becomes the administrator of the new tenant:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"a. Tenant creation"),(0,i.kt)("li",{parentName:"ul"},"b. Link the logged-in user to the created tenant"),(0,i.kt)("li",{parentName:"ul"},"c. Set the logged-in user as the admin of the tenant")))),(0,i.kt)("h4",{id:"214-user-list-retrieval-api"},"2.1.4. User List Retrieval API"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-go/blob/main/main.go#L156"},"Go(echo) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'e.GET("/users", getUsers, authMiddleware)')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-python/blob/main/main.py#L58"},"Python(FastAPI) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'@app.get("/users")')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-java/blob/main/src/main/java/implementsample/controller/SampleController.java#L82"},"Java(Maven) implementation sample"),(0,i.kt)("br",{parentName:"li"}),(0,i.kt)("inlineCode",{parentName:"li"},'@GetMapping(value = "/users", produces = "application/json")'))),(0,i.kt)("p",null,"It is always necessary to confirm the login by retrieving the user information to verify that the API request originates from the user that is logged into SaaSus Platform."),(0,i.kt)("h4",{id:"22-how-to-use-the-implementation-example"},"2.2. How to use the implementation example"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-go/blob/main/README.md"},"Go(echo)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-python"},"Python(FastAPI)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/saasus-platform/implementation-sample-api-java"},"Java(Maven)"))))}c.isMDXComponent=!0},76192:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/SaaSus_PlatformAPI-3b5185c7651e9035721f720bd05955e0.png"},21690:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-02-6c182132c9826cede4a323a0bfc95320.png"}}]);