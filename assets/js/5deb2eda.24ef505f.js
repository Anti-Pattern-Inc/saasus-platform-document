"use strict";(self.webpackChunksaasus_platform_document=self.webpackChunksaasus_platform_document||[]).push([[9539],{3448:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image-01-f242aefa8c65c1023c42b7c74c4cb0ac.png"},5849:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"part-6/implementation-guide/sample-application/activity-history-log","title":"Activity History Log Implementation","description":"This guide explains implementation patterns and methods for effectively utilizing activity history logs.","source":"@site/versioned_docs/version-1.12/part-6/implementation-guide/sample-application/activity-history-log.md","sourceDirName":"part-6/implementation-guide/sample-application","slug":"/part-6/implementation-guide/sample-application/activity-history-log","permalink":"/docs/part-6/implementation-guide/sample-application/activity-history-log","draft":false,"unlisted":false,"tags":[],"version":"1.12","frontMatter":{"title":"Activity History Log Implementation","slug":"activity-history-log","excerpt":"Implementation patterns and methods for effectively utilizing activity history logs in your application","hidden":false,"createdAt":"Wed Sep 03 2025 05:28:00 GMT+0000 (Coordinated Universal Time)","updatedAt":"Thu Oct 09 2025 00:00:00 GMT+0000 (Coordinated Universal Time)"},"sidebar":"docsSidebar","previous":{"title":"Multi-Factor Authentication","permalink":"/docs/part-6/implementation-guide/sample-application/multi-factor-authentication"},"next":{"title":"Plan Change Implementation","permalink":"/docs/part-6/implementation-guide/sample-application/plan-change-implementation"}}');var r=n(74848),i=n(28453),s=n(65537),o=n(79329);const l={title:"Activity History Log Implementation",slug:"activity-history-log",excerpt:"Implementation patterns and methods for effectively utilizing activity history logs in your application",hidden:!1,createdAt:"Wed Sep 03 2025 05:28:00 GMT+0000 (Coordinated Universal Time)",updatedAt:"Thu Oct 09 2025 00:00:00 GMT+0000 (Coordinated Universal Time)"},c=void 0,d={},u=[{value:"Implementation Points and Recommended Patterns",id:"implementation-points-and-recommended-patterns",level:2},{value:"Using the <code>X-SaaSus-Referer</code> Header",id:"using-the-x-saasus-referer-header",level:3},{value:"Implementation Points for Frontend",id:"implementation-points-for-frontend",level:3},{value:"Basic: Recording Page Views",id:"basic-recording-page-views",level:4},{value:"Advanced: Recording Page Actions",id:"advanced-recording-page-actions",level:4},{value:"Output Example",id:"output-example",level:2}];function p(e){const t={code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"This guide explains implementation patterns and methods for effectively utilizing activity history logs."}),"\n",(0,r.jsxs)(t.p,{children:["Activity history logs are records of calls to ",(0,r.jsx)(t.code,{children:"GetUserInfo"})," with ",(0,r.jsx)(t.code,{children:"Referer"})," or ",(0,r.jsx)(t.code,{children:"X-SaaSus-Referer"})," headers. By properly setting these headers in the frontend, you can enhance the value of the logs."]}),"\n",(0,r.jsx)(t.h2,{id:"implementation-points-and-recommended-patterns",children:"Implementation Points and Recommended Patterns"}),"\n",(0,r.jsxs)(t.h3,{id:"using-the-x-saasus-referer-header",children:["Using the ",(0,r.jsx)(t.code,{children:"X-SaaSus-Referer"})," Header"]}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Referer"})," header automatically set by browsers may omit URL path portions due to privacy settings. When the expected value is not set, we recommend manually setting the ",(0,r.jsx)(t.code,{children:"X-SaaSus-Referer"})," header from the frontend."]}),"\n",(0,r.jsx)(s.A,{children:(0,r.jsx)(o.A,{value:"typescript",label:"TypeScript",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"await fetch(url, {\n  headers: {\n    'Authorization': `Bearer ${jwtToken}`,\n    'X-SaaSus-Referer': window.location.pathname\n  }\n});\n"})})})}),"\n",(0,r.jsx)(t.h3,{id:"implementation-points-for-frontend",children:"Implementation Points for Frontend"}),"\n",(0,r.jsx)(t.p,{children:"Here are the recommended implementation patterns for effectively utilizing activity history logs in frontend applications. We use React sample code here, but the same concepts can be applied to other frameworks and traditional multi-page applications."}),"\n",(0,r.jsx)(t.p,{children:"Note that activity history logs are recorded when GetUserInfo is executed, so please ensure that GetUserInfo is executed at each endpoint."}),"\n",(0,r.jsx)(t.h4,{id:"basic-recording-page-views",children:"Basic: Recording Page Views"}),"\n",(0,r.jsxs)(t.p,{children:["In SPAs, it's common to send multiple API requests to display a single page. In such cases, setting the same page path in ",(0,r.jsx)(t.code,{children:"X-SaaSus-Referer"}),' for all API requests ensures that activity history logs are correctly recorded as "pages the user accessed," making them easy to understand.']}),"\n",(0,r.jsxs)(t.p,{children:["Using the ",(0,r.jsx)(t.code,{children:"useLocation"})," hook from ",(0,r.jsx)(t.code,{children:"react-router-dom"}),", define common headers as shown below and reuse them for API requests related to page display."]}),"\n",(0,r.jsx)(s.A,{children:(0,r.jsx)(o.A,{value:"typescript",label:"TypeScript",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:'import { useEffect } from "react";\nimport { useLocation } from "react-router-dom";\nimport axios from "axios";\n\nconst UserPage = () => {\n  const location = useLocation();\n  const pagePath = location.pathname; // Example: "/users"\n  const jwtToken = localStorage.getItem("SaaSusIdToken");\n\n  // Define headers to be used commonly within the page\n  const commonHeaders = {\n    "X-Requested-With": "XMLHttpRequest",\n    Authorization: `Bearer ${jwtToken}`,\n    "X-SaaSus-Referer": pagePath,\n  };\n\n  // Use these common headers for each API request executed when displaying the page\n  useEffect(() => {\n    const fetchData = async () => {\n      await axios.get(\'/users\', { headers: commonHeaders });\n      await axios.get(\'/user_attributes\', { headers: commonHeaders });\n    };\n    fetchData();\n  }, []);\n\n  // ...\n};\n'})})})}),"\n",(0,r.jsxs)(t.p,{children:["By implementing this way, all API requests related to displaying ",(0,r.jsx)(t.code,{children:"UserPage"})," will be consistently recorded in the logs as access to ",(0,r.jsx)(t.code,{children:"/users"}),'. Since multiple APIs are called when displaying a page, the same path will be recorded multiple times in a short period in the logs, but this is intended normal behavior. This ensures that "the user was active on this page at this time" is recorded.']}),"\n",(0,r.jsx)(t.h4,{id:"advanced-recording-page-actions",children:"Advanced: Recording Page Actions"}),"\n",(0,r.jsx)(t.p,{children:'Beyond page views, recording specific actions within pages such as "which button was pressed" further increases the value of the logs.'}),"\n",(0,r.jsxs)(t.p,{children:["In such cases, we recommend adding query parameters like ",(0,r.jsx)(t.code,{children:"?action=..."})," to the URL set in ",(0,r.jsx)(t.code,{children:"X-SaaSus-Referer"})," to express context."]}),"\n",(0,r.jsx)(s.A,{children:(0,r.jsx)(o.A,{value:"typescript",label:"TypeScript",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:'// Continuation of UserPage component\n\nconst handleDeleteUser = async (userId: string) => {\n  // Define headers specific to this delete action\n  const actionHeaders = {\n    ...commonHeaders, // Copy commonHeaders and\n    // Overwrite Referer with action information\n    "X-SaaSus-Referer": `${pagePath}?action=delete_user`,\n  };\n\n  try {\n    await axios.delete(`/users/${userId}`, {\n      headers: actionHeaders, // Use action-specific headers\n    });\n    // ... Success handling\n  } catch (error) {\n    // ... Error handling\n  }\n};\n'})})})}),"\n",(0,r.jsx)(t.p,{children:'This approach creates logs that clearly show the flow: "user opened the user list page (multiple logs), then executed deletion (action log)," making them easy to analyze.'}),"\n",(0,r.jsx)(t.h2,{id:"output-example",children:"Output Example"}),"\n",(0,r.jsx)(t.p,{children:"The following shows an example of activity history logs recorded by the above implementation:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Activity History Log Output Example",src:n(3448).A+"",width:"1440",height:"735"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>o});var a=n(96540);const r={},i=a.createContext(r);function s(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:t},e.children)}},65537:(e,t,n)=>{n.d(t,{A:()=>w});var a=n(96540),r=n(34164),i=n(65627),s=n(56347),o=n(50372),l=n(30604),c=n(11861),d=n(78749);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const r=(0,s.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(i),(0,a.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(r.location.search);t.set(i,e),r.replace({...r.location,search:t.toString()})}),[i,r])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,i=p(e),[s,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:i}))),[c,u]=m({queryString:n,groupId:r}),[f,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,i]=(0,d.Dv)(n);return[r,(0,a.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:r}),v=(()=>{const e=c??f;return h({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{v&&l(v)}),[v]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),g(e)}),[u,g,i]),tabValues:i}}var g=n(9136);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=n(74848);function x(e){let{className:t,block:n,selectedValue:a,selectValue:s,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),r=o[n].value;r!==a&&(c(t),s(r))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>{l.push(e)},onKeyDown:u,onClick:d,...i,className:(0,r.A)("tabs__item",v.tabItem,i?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function b(e){let{lazy:t,children:n,selectedValue:i}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===i));return e?(0,a.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function j(e){const t=f(e);return(0,y.jsxs)("div",{className:(0,r.A)("tabs-container",v.tabList),children:[(0,y.jsx)(x,{...t,...e}),(0,y.jsx)(b,{...t,...e})]})}function w(e){const t=(0,g.A)();return(0,y.jsx)(j,{...e,children:u(e.children)},String(t))}},79329:(e,t,n)=>{n.d(t,{A:()=>s});n(96540);var a=n(34164);const r={tabItem:"tabItem_Ymn6"};var i=n(74848);function s(e){let{children:t,hidden:n,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,s),hidden:n,children:t})}}}]);